<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta property="og:title" content="" />
<meta property="og:description" content="Sarek: a Variant Calling Pipeline #  In order to carry out a germline variant calling analysis we will use the nf-core pipeline sarek.
Overview #  The pipeline is organised following the three main analysis blocks we previously described: pre-processing, variant calling and annotation.
 In each analysis block, the user can choose among a range of different options in terms of aligners, callers and software to carry out the annotation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://example.org/tutorial/2.sarek/" /><meta property="article:section" content="tutorial" />

<meta property="og:site_name" content="ðŸ““ Amethyst" />

<title>2.Sarek | ðŸ““ Amethyst</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.5a2664b4517d55ec16199b62d0903d0484859e7f9aded9023c0b399e6a03e519.css" integrity="sha256-WiZktFF9VewWGZti0JA9BISFnn&#43;a3tkCPAs5nmoD5Rk=" crossorigin="anonymous">

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
  



<meta charset="UTF-8" />
<meta
  name="description"
  content="Sarek: a Variant Calling Pipeline #  In order to carry out a germline variant calling analysis we will use the nf-core pipeline sarek.
Overview #  The pipeline is organised following the three main analysis blocks we previously described: pre-processing, variant calling and annotation.
 In each analysis block, the user can choose among a range of different options in terms of aligners, callers and software to carry out the annotation."
/>
<title>
  ðŸ““ Amethyst
</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />






<link rel="shortcut icon" type="image/png"  href="http://example.org//favicon.png" />

























  
  


<link href="http://example.org/styles.e08ceb33360cec132feb69cfb982e2a4.min.css" rel="stylesheet" />


<link href="http://example.org/quartz/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css" rel="stylesheet" id="theme-link">

  

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" as="style"
      onload="this.onload=null;this.rel='stylesheet'"
      integrity="sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
        integrity="sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx"
        crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js"
        integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"
        crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js"
        integrity="sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A"
        crossorigin="anonymous"></script>

  






<script src="http://example.org/quartz/js/darkmode.2dde094b8728e01ab3f1666d1d15dd1b.min.js"></script>



<script src="http://example.org/quartz/js/util.c69e233dc1cc331a30b0f670e657b425.min.js"></script>



<script async src="https://unpkg.com/@floating-ui/core@0.7.3"></script>
<script async src="https://unpkg.com/@floating-ui/dom@0.5.4"></script>

<script src="http://example.org/quartz/js/popover.f03552ccb84d99ca615d1cfb9abde59e.min.js"></script>




<script defer src="http://example.org/quartz/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js"></script>




<script defer src="http://example.org/quartz/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js"></script>




<script defer src="http://example.org/quartz/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js"></script>



 
<script>
  const SEARCH_ENABLED =  false 
  const LATEX_ENABLED =  true 
  const PRODUCTION =  true 
  const BASE_URL = "http://example.org/"
  const fetchData = Promise.all([
        fetch("http:\/\/example.org\/indices\/linkIndex.f6425e3c9c5a78cb1a57d6271bd0c88d.min.json")
          .then(data => data.json())
          .then(data => ({
            index: data.index,
            links: data.links,
          })),
        fetch("http:\/\/example.org\/indices\/contentIndex.56753ef950db2332e50166167e5b613e.min.json")
          .then(data => data.json()),
      ])
      .then(([{index, links}, content]) => ({
        index,
        links,
        content,
      }))

    const render = () => {
    
    const siteBaseURL = new URL(BASE_URL);
    const pathBase = siteBaseURL.pathname;
    const pathWindow = window.location.pathname;
    const isHome = pathBase == pathWindow;

    addCopyButtons();
    

    

    addCollapsibleCallouts();
    

    
    initPopover(
      "http://example.org",
       true 
    )
    

    

    
      var els = document.getElementsByClassName("mermaid");
      if (els.length > 0) {
        import('https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs').then(
          (obj) => {
            
            
            obj.default.init();
          }
        )
      }
    
  }

  const init = (doc = document) => {
    
    addCopyButtons();
    

    addTitleToCodeBlocks();
    renderMathInElement(doc.body, {
      delimiters: [
        {left: '$$', right: '$$', display: true},
        {left: '$', right: '$', display: false},
      ],
      macros: {
        'â€™': "'"
      },
      throwOnError : false
    });
    
  };
</script>

<script>
  window.Million = {
    navigate: (url) => (window.location.href = url),
    prefetch: () => {},
  }

  window.addEventListener("DOMContentLoaded", () => {
    init()
    render()
  })
</script>


</head>
<div id="search-container">
  <div id="search-space">
    <input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search"
      placeholder="Search for something..." dir="">
    <div id="results-container">
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js"
  integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin="anonymous" defer></script>

<script defer src="http://example.org/quartz/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js"></script>



<header class="book-header">
    
    <label for="menu-control">
      <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
    </label>
    <h1 id="page-title"><a href="http://example.org/">ðŸ““ Amethyst</a></h1>
    <div class="spacer"></div>
    <div id="search-icon" class="quartz-search">
      <p>Search</p>
      <svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg>
    </div>
    <div class='darkmode'>
    <input class='toggle' id='darkmode-toggle' type='checkbox' tabindex="-1">
    <label id="toggle-label-light" for='darkmode-toggle' tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35;" xml:space="preserve">
            <title>Light Mode</title>
            <path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z" />
        </svg>
    </label>
    <label id="toggle-label-dark" for='darkmode-toggle' tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'" xml:space="preserve">
            <title>Dark Mode</title>
            <path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z" />
        </svg>
    </label>
</div>
</header>


<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <main class="flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<div class="menu-search">
  <div id="search-icon" class="quartz-search">
    <p>Search</p>
    <svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7">
      <title id="title">Search Icon</title>
      <desc id="desc">Icon to open search</desc>
      <g class="search-path" fill="none">
        <path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4" />
        <circle cx="8" cy="8" r="7" />
      </g>
    </svg>
  </div>
</div>













  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span class="book-menu-title">Getting Started</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/tutorial/1.theory/" class="">1.Theory</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/tutorial/2.sarek/" class="active">2.Sarek</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/tutorial/3.interpretation/" class="">3.Interpretation</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="https://github.com/64bitpandas/amethyst"  target="_blank" rel="noopener">
        Github
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>
    <div class="book-page container">
      

      
      
  <article class="markdown">
    <h1 class="title">2.Sarek</h1>
    






  
  

  
  

  
  

  
  

  
  

  
  

  
  















  
  
  
  
  
  
  
  
  
  






<h1 id="sarek-a-variant-calling-pipeline">
  Sarek: a Variant Calling Pipeline
  <a class="anchor" href="#sarek-a-variant-calling-pipeline">#</a>
</h1>
<p>In order to carry out a germline variant calling analysis we will use the nf-core pipeline 
<a href="https://nf-co.re/sarek/3.3.2" rel="noopener">sarek</a>.</p>
<h2 id="overview">
  Overview
  <a class="anchor" href="#overview">#</a>
</h2>
<p>The pipeline is organised following the three main analysis blocks we previously described: pre-processing, variant calling and annotation.</p>
<p>


<img src="http://example.org/tutorial/./img/sarek_subway.png" width="auto" alt="sarek_overview"  /></p>
<p>In each analysis block, the user can choose among a range of different options in terms of aligners, callers and software to carry out the annotation.
The analysis can also start from different steps, depending the input available and whether it has been partially processed already.</p>
<h2 id="experimental-design">
  Experimental Design
  <a class="anchor" href="#experimental-design">#</a>
</h2>
<p>In order to choose the different options Sarek offers, the user should collect a few key elements of the experimental design before beginning the analysis.</p>
<h3 id="library-design">
  Library design
  <a class="anchor" href="#library-design">#</a>
</h3>
<p>If the experiment used a capture (or targeted) strategy, the user will need to make sure the <code>bed</code> file with the target regions is available.
This file will be useful if the user wants to limit variant calling and annotation to those regions.
In this case the file can be passed to Sarek command line using the <code>--intervals target.bed</code> parameter.
Should the sequencing strategy be a <em>whole exome</em> or <em>panel</em>, the pipeline gives the possibility to enable specific settings for this library type, using the parameter <code>--wes</code>.</p>
<h3 id="reference-genome">
  Reference genome
  <a class="anchor" href="#reference-genome">#</a>
</h3>
<p>nf-core pipelines make use of the Illumina iGenomes collection as 
<a href="https://nf-co.re/docs/usage/reference_genomes" rel="noopener">reference genomes</a>.
Before starting the analysis, the user might want to check whether the genome they need is part of this collection.
They also might want to consider downloading the reference locally, when running on premises: this would be useful for multiple runs and to speed up the analysis. In this case the parameter <code>--igenomes_base</code> might be used to pass the root directory of the downloaded references.</p>
<p>One might also need to use custom files: in this case the user might either provide specific parameters at command line, or create a config file adding a new section to the <code>genome</code> object. See 
<a href="https://nf-co.re/docs/usage/reference_genomes#custom-genomes" rel="noopener">here</a> for more details.</p>
<p>We will follow this specific approach in this tutorial, since the data we will be using have been simulated on chromosome 21 of the Human GRCh38 reference, and we have prepared fasta, indexes and annotation files containing only this chromosome locally.</p>
<h3 id="input-files">
  Input files
  <a class="anchor" href="#input-files">#</a>
</h3>
<p>The input data should be provided in a CSV file, according to a format that is largely common for nf-core pipelines.
The format is described in the 
<a href="https://nf-co.re/sarek/3.3.2/docs/usage#input-sample-sheet-configurations" rel="noopener">sarek usage page</a>.</p>
<h2 id="gatk-best-practices">
  GATK Best Practices
  <a class="anchor" href="#gatk-best-practices">#</a>
</h2>
<p>During this tutorial we will use the options Sarek offers to follow the 
<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360035535932-Germline-short-variant-discovery-SNPs-Indels-" rel="noopener">GATK best practices workflow</a>.</p>
<p>This is solely for educational purposes, since the tutorial dataset includes only 2 samples: while joint-genotyping is a valid choice, the use of soft filtering for such a limited dataset will not offer significant improvements. Additionally, running VQSR on a small dataset will incur in issues with some annotations and will require limiting this step to fewer parameters than usual.</p>
<h2 id="running-sarek-germline">
  Running Sarek Germline
  <a class="anchor" href="#running-sarek-germline">#</a>
</h2>
<p>In the following sections we will first prepare our references, then set our computational resources in order to be able to run the pipeline on a gitpod VM, edit the filtering settings and finally run the pipeline.</p>
<h3 id="reference-genome-1">
  Reference Genome
  <a class="anchor" href="#reference-genome-1">#</a>
</h3>
<p>Following the considerations above, we will first of all edit the <code>nextflow.config</code> file in our working directory to add a new genome.
It is sufficient to add the following code to the <code>parameters</code> directive in the config.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">igenomes_base <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/workspace/gitpod/nf-training/data/refs/&#39;</span>
genomes <span style="color:#f92672">{</span>
	<span style="color:#e6db74">&#39;GRCh38chr21&#39;</span> <span style="color:#f92672">{</span>
		bwa                   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/sequence/Homo_sapiens_assembly38_chr21.fasta.{amb,ann,bwt,pac,sa}&#34;</span>
		dbsnp                 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/annotations/dbsnp_146.hg38_chr21.vcf.gz&#34;</span>
		dbsnp_tbi             <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/annotations/dbsnp_146.hg38_chr21.vcf.gz.tbi&#34;</span>
		dbsnp_vqsr            <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;--resource:dbsnp,known=false,training=true,truth=false,prior=2.0 dbsnp_146.hg38_chr21.vcf.gz&#39;</span>
		dict                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/sequence/Homo_sapiens_assembly38_chr21.dict&#34;</span>
		fasta                 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/sequence/Homo_sapiens_assembly38_chr21.fasta&#34;</span>
		fasta_fai             <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/sequence/Homo_sapiens_assembly38_chr21.fasta.fai&#34;</span>
		germline_resource     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/annotations/gnomAD.r2.1.1.GRCh38.PASS.AC.AF.only_chr21.vcf.gz&#34;</span>
		germline_resource_tbi <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/annotations/gnomAD.r2.1.1.GRCh38.PASS.AC.AF.only_chr21.vcf.gz.tbi&#34;</span>
		known_snps            <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/annotations/1000G_phase1.snps.high_confidence.hg38_chr21.vcf.gz&#34;</span>
		known_snps_tbi        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/annotations/1000G_phase1.snps.high_confidence.hg38_chr21.vcf.gz.tbi&#34;</span>
		known_snps_vqsr       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;--resource:1000G,known=false,training=true,truth=true,prior=10.0 1000G_phase1.snps.high_confidence.hg38_chr21.vcf.gz&#39;</span>
		known_indels          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/annotations/Mills_and_1000G_gold_standard.indels.hg38_chr21.vcf.gz&#34;</span>
		known_indels_tbi      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${params.igenomes_base}/annotations/Mills_and_1000G_gold_standard.indels.hg38_chr21.vcf.gz.tbi&#34;</span>
		known_indels_vqsr     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;--resource:mills,known=false,training=true,truth=true,prior=10.0 Mills_and_1000G_gold_standard.indels.hg38_chr21.vcf.gz&#39;</span>
		snpeff_db             <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;105&#39;</span>
		snpeff_genome         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;GRCh38&#39;</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="computing-resources">
  Computing resources
  <a class="anchor" href="#computing-resources">#</a>
</h3>
<p>Based on the choices we made when starting up the gitpod environment, we recommend to use the following additional parameters.
They can also be added to the parameters directive in the config file we just edited.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">params <span style="color:#f92672">{</span>
    max_cpus                  <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
    max_memory                <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;6.5GB&#39;</span>
    max_time                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2.h&#39;</span>
    use_annotation_cache_keys <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>The parameter <code>use_annotation_cache_keys</code> allows the annotation software to deal with the local paths when the cache is downloaded on the environment.</p>
<h3 id="filtering-parameters">
  Filtering parameters
  <a class="anchor" href="#filtering-parameters">#</a>
</h3>
<p>As we mentioned earlier, we will be using the VQSR filtering tool once the variants have been called.
However, this tool should be used to take advantage of larger amount of variant annotations and improve filtering: when a small tutorial dataset is used, some of the annotations will not have sufficient data or might even have no variance.
In order to account for this, we have to change the filtering options and limit this approach to a subset of variant annotations.</p>
<p>We can do this by editing the process descriptors for the Sarek modules running VQSR for both single nucleotide variants and insertion/deletions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">process <span style="color:#f92672">{</span>
    withName: <span style="color:#e6db74">&#39;VARIANTRECALIBRATOR_INDEL&#39;</span> <span style="color:#f92672">{</span>
        ext<span style="color:#f92672">.</span><span style="color:#a6e22e">prefix</span> <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> <span style="color:#e6db74">&#34;${meta.id}_INDEL&#34;</span> <span style="color:#f92672">}</span>
        ext<span style="color:#f92672">.</span><span style="color:#a6e22e">args</span>   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;-an QD -an FS -an SOR -an DP  -mode INDEL&#34;</span>
        publishDir <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
            enabled: <span style="color:#66d9ef">false</span>
        <span style="color:#f92672">]</span>
    <span style="color:#f92672">}</span>

    withName: <span style="color:#e6db74">&#39;VARIANTRECALIBRATOR_SNP&#39;</span> <span style="color:#f92672">{</span>
        ext<span style="color:#f92672">.</span><span style="color:#a6e22e">prefix</span> <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> <span style="color:#e6db74">&#34;${meta.id}_SNP&#34;</span> <span style="color:#f92672">}</span>
        ext<span style="color:#f92672">.</span><span style="color:#a6e22e">args</span>   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;-an QD -an MQ -an FS -an SOR -mode SNP&#34;</span>
        publishDir <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
            enabled: <span style="color:#66d9ef">false</span>
        <span style="color:#f92672">]</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="launching-the-pipeline">
  Launching the pipeline
  <a class="anchor" href="#launching-the-pipeline">#</a>
</h3>
<p>Now we are ready to launch the pipeline, and we can use the following command line:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nextflow run nf-core/sarek <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--input /workspace/gitpod/nf-training/data/reads/variantcalling/sarek-input.csv <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--outdir . <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--tools haplotypecaller,snpeff <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--genome GRCh38chr21 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--joint_germline <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--intervals /workspace/gitpod/nf-training/variantcalling/exome_target_hg38_chr21.bed <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--wes
</code></pre></div><p>Notice that we have selected <code>--joint_germline</code> to enable the joint-genotyping workflow, we have specified our library strategy is using a capture with <code>--wes</code> and we have provided a bed file with the targets with <code>--intervals</code>.
The target file in this case refers to the capture intervals on chromosome 21 only, where the data have been simulated.</p>
<p>The whole pipeline from FASTQ input to annotated VCF should run in about 25 minutes.</p>
<p>Our final VCF file will be located in</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./annotation/haplotypecaller/joint_variant_calling
</code></pre></div>

    

<hr/>


<div class="page-end" id="footer">
    <div class="backlinks-container">
        <h3>Backlinks</h3>
<ul class="backlinks">
    
    
    
    
    
    
    
    <li>
      No backlinks found
    </li>
    
</ul>

    </div>
    <div>
        <script
  src="https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js"
  integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI="
  crossorigin="anonymous"
></script>
<h3>Interactive Graph</h3>
<div id="graph-container"></div>
<style>
  :root {
    --g-node: var(--secondary);
    --g-node-active: var(--primary);
    --g-node-inactive: var(--visited);
    --g-link: var(--outlinegray);
    --g-link-active: #5a7282;
  }
</style>

<script src="http://example.org/quartz/js/graph.cbd78cfa87df7d3e230d16fc24f06548.js"></script>

    </div>
</div>






<div id="contact_buttons">
    <footer>
        
        
        <p>Made with <a href="https://github.com/64bitpandas/amethyst">Amethyst</a>, Â© 2024 Ben Cuan</p>
        <ul>
            
            <li><a href="http://example.org/">Home</a></li>
            <li><a href="https://bencuan.me">Website</a></li><li><a href="https://blog.bencuan.me">Blog</a></li></ul>
    </footer>
</div>


    
  </article>
 
      
      
      
      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#experimental-design">Experimental Design</a>
      <ul>
        <li><a href="#library-design">Library design</a></li>
        <li><a href="#reference-genome">Reference genome</a></li>
        <li><a href="#input-files">Input files</a></li>
      </ul>
    </li>
    <li><a href="#gatk-best-practices">GATK Best Practices</a></li>
    <li><a href="#running-sarek-germline">Running Sarek Germline</a>
      <ul>
        <li><a href="#reference-genome-1">Reference Genome</a></li>
        <li><a href="#computing-resources">Computing resources</a></li>
        <li><a href="#filtering-parameters">Filtering parameters</a></li>
        <li><a href="#launching-the-pipeline">Launching the pipeline</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












